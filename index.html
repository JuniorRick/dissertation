<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>WebGL</title>
  <!-- <link rel="stylesheet" href="bulma.min.css"> -->
  <link rel="stylesheet" href="style.css">
  <style>
    html,
    body {
      margin: 0;
      padding: 0;
      height: 100vh;
    }
  </style>
</head>

<body>

  <section class="section">

    <div id="main-page">
      <h1 class="title">Teza de master</h1>
      <div class="content">
        CERCETAREA METODELOR DE OPTIMIZARE A
        PROGRAMĂRII GRAFICE 3D ÎN WEBGL
      </div>
      <div class="footer">
        <div>Autor: Stinca Erast</div>
        <div>Conducator stiintific: Pereteatcu Sergiu,
          <br>
          doctor conferentiar universitar
        </div>
      </div>
      <a id="from-main-page" href="#page-2">
        <div class="arrow arrow-right"></div>
      </a>
    </div>

    <div class="container" id="page-2">
      <h1 class="title">Actualitatea temei:</h1>
      <div class="content">
        Grafica digitală este o activitate în care computerul este utilizat
        pentru prelucrarea informației vizuale.<br>
        Odată cu apariția tehnologiilor web a aparut si necesitatea
        prezentării graficii in browser.
      </div>
      <a id="to-main-page" href="#main-page">
        <div class="arrow arrow-left"></div>
      </a>
      <a href="#page-3"><div class="arrow arrow-right"></div></a>
    </div>

    <div class="container" id="page-3">
      <h1 class="title">Grafica în browser</h1>
      <div class="content">
        <div class="grid-container grid-2">
            <div class="grid-item">
              <h5 class="subtitle">HTML5 video element</h5>
              <video width="200" autoplay loop muted>
                <source src="images/mov_bbb.mp4" type="video/mp4">
                Your browser does not support HTML5 video.
              </video>
            </div>
            <div class="grid-item">
              <h5 class="subtitle">CanvasRenderingContext2D </h5>
                <canvas id="myCanvas" width="200" height="150"></canvas>
            </div>
            <div class="grid-item">
            <h5 class="subtitle">SVG</h5>
              <svg width="200" height="150">
                <rect width="200" height="150"
                  style="fill:rgb(0,255,255);" />
                <rect x="50" y="25" width="100" height="100"
                  style="fill:rgb(0,0,255);" />
                  Sorry, your browser does not support inline SVG.
              </svg>
            </div>
            <div class="grid-item">
              <h5 class="subtitle">WebGL</h5>
              <canvas id="glCanvas" width="200" height="150"></canvas>
            </div>
        </div>
      </div>
      <a href="#page-2"><div class="arrow arrow-left"></div></a>
      <a href="#page-4"><div class="arrow arrow-right"></div></a>
    </div>

    <div class="container" id="page-4">
      <h1 class="title">De ce WebGL?</h1>
      <div class="content">
        WebGL permite afisarea graficii 3D interactivă fără a utiliza
        plug-in-uri. Funcționează cu orice platformă care acceptă OpenGL.
      </div>
      <a href="#page-3"><div class="arrow arrow-left"></div></a>
      <a href="#page-5"><div class="arrow arrow-right"></div></a>
    </div>

    <div class="container" id="page-5">
      <h1 class="title">
        Avantajele WebGL asupra altor metode de prezentare a graficii:
      </h1>
      <div class="content">
        - Datele elementului <code>&lt;video&gt;</code> ar trebui să fie video,
        dar ar putea avea și audio sau imagini asociate cu acesta, dar nu poate
        conține grafică interactivă spre deosebide de WebGL. <br><br>
        - SVG nu poate produce efecte complexe de iluminare și de
        material reflectorizant <br><br>
        - Contextul WebGL este mult mai rapid decât contextul 2D deoarece WebGL permite utilizare accelerată GPU la
        procesarea imaginilor<br><br>
      </div>
      <a href="#page-4"><div class="arrow arrow-left"></div></a>
      <a href="#page-6"><div class="arrow arrow-right"></div></a>
    </div>

    <div class="container" id="page-6">
      <h1 class="title">Exemple WebGL</h1>
      <div class="content">
        <div class="grid-container grid-2">
          <div class="grid-item">
            <h5 class="subtitle"> biomuri generate pe bază de noise</h5>
            <a href="https://demo.marpi.pl/biomes/" target="_blank">
              <img src="images/biomes.png" alt="">
            </a>
          </div>
          <div class="grid-item">
            <h5 class="subtitle">Simulare Fluid</h5>
              <a href="https://paveldogreat.github.io/WebGL-Fluid-Simulation/"
               target="_blank"><img src="images/fluid.png" alt=""></a>
          </div>
          <div class="grid-item">
            <h5 class="subtitle">Structura chimică Ampicilline (screenshot) </h5>
            <img src="images/ampicillin.png"></img>
          </div>
          <div class="grid-item">
            <h5 class="subtitle">Fibrilația atrială (screenshot)</h5>
            <img src="images/heart.png"></img>
          </div>

        </div>
      </div>
      <a href="#page-5"><div class="arrow arrow-left"></div></a>
      <a href="#page-7"><div class="arrow arrow-right"></div></a>
    </div>

    <div class="container" id="page-7">
      <h1 class="title">Pipeline</h1>
      <div class="content">
            <img src="images/graphicPipeline.jpg">
            <div>
              Procesul de la declararea vârfurilor până la transformarea în culori
              finale ale pixelilor se numește conducta grafică (grapics pipeline).
              Această conductă conține o serie de pași prin care fiecare
              cadru va fi procesat.
            </div>
        </div>
      <a href="#page-6"><div class="arrow arrow-left"></div></a>
      <a href="#page-8"><div class="arrow arrow-right"></div></a>
    </div>

    <div class="container" id="page-8">
      <h1 class="title">Structura unei aplicații WebGL:</h1>
      <div class="content">
        <img src="images/goesin.jpg" alt="">
        <div>
          Toate acestea sunt opționale cu exceptia programului de shader,
          compus din vertex shader și fragment shader.
        </div>
      </div>
      <a href="#page-7"><div class="arrow arrow-left"></div></a>
      <a href="#page-9"><div class="arrow arrow-right"></div></a>
    </div>

    <div class="container" id="page-9">
      <h1 class="title">Buffer</h1>
      <div class="content">
        <img src="images/buffer.png" alt="">
        <div>Un buffer de date este o regiune a unei memorii folosită pentru
          stocarea temporară a datelor în timp ce este mutată
          dintr-un loc în altul.</div>
      </div>
      <a href="#page-8"><div class="arrow arrow-left"></div></a>
      <a href="#page-10"><div class="arrow arrow-right"></div></a>
    </div>
    <div class="container" id="page-10">
      <h1 class="title">Rasterizare</h1>
      <div class="content">
      <div>
        Procesul de transformare a figurilor geometrice definite într-un format vectorial
        în fragmente (pixeli sau puncte) pentru a fi afișate pe un ecran video
        se numeste rasterizare.
      </div>
      </div>
      <a href="#page-9"><div class="arrow arrow-left"></div></a>
      <a href="#page-11"><div class="arrow arrow-right"></div></a>
    </div>
    <div class="container" id="page-11">
      <h1 class="title">Fragment</h1>
      <div class="content">
        <img src="images/fragment.png" alt="">
        <div>
          Un pixel generat de procesul de rasterizare care are culoare,
          adâncime, valoare, coordonate de textură și multe altele se
          numeste fragment.
         </div>
      </div>
      <a href="#page-10"><div class="arrow arrow-left"></div></a>
      <a href="#page-12"><div class="arrow arrow-right"></div></a>
    </div>
    <div class="container" id="page-12">
      <h1 class="title">Shaders</h1>
      <div class="content">
        <div>
          Un shader este un mic program cu sintaxa asemănătoare limbajului C
          și rulează pe GPU. Un shader program este compus din vertex
          shader și fragment shader: <br>
          <ul>
            <li>Vertex shader este executat pentru fiecare vârf</li>
            <li>Fragment shader este executat pentru fiecare fragment,
              valorile culorilor fiind interpolate între ele.</li>
          </ul>
        </div>
      </div>
      <a href="#page-11"><div class="arrow arrow-left"></div></a>
      <a href="#page-13"><div class="arrow arrow-right"></div></a>
    </div>
    <div class="container" id="page-13">
      <h1 class="title">Interpolarea culorilor</h1>
      <div class="content">
        <div class="grid-container grid-2">
          <div class="grid-item">
            <div class="subtitle">Daca vârfurile unui triunghi au aceleași
              culori atunci nu are loc interpolarea
            </div>
            <img src="images/noninterpolation.png" alt="">

          </div>
          <div class="grid-item">
            <div class="subtitle">Interpolarea are loc atunci când un triunghi are
              culori diferite ale vârfurilor
            </div>
            <img src="images/interpolation.png" alt="">
          </div>
        </div>
      </div>
      <a href="#page-12"><div class="arrow arrow-left"></div></a>
      <a href="#page-14"><div class="arrow arrow-right"></div></a>
    </div>

    <div class="container" id="page-14">
      <h1 class="title">Contextul WebGL</h1>
      <div class="content">
        <img src="images/webgl_context.png" alt="">
        <!-- The Modal -->
        <div id="myModal" class="modal" id="webGlContext">
          <!-- Modal content -->
          <div class="modal-content">
            <p>Contextul webGL</p>
            <span class="close">&times;</span>
            <img src="images/context.png" alt="">
          </div>
        </div>
        <div class="footer">
          <button id="contextBtn" class="btn">Imaginea randată</button>
        </div>
      </div>
      <a href="#page-13"><div class="arrow arrow-left"></div></a>
      <a href="#page-15"><div class="arrow arrow-right"></div></a>
    </div>

    <div class="container" id="page-15">
      <h1 class="title">Vertex Shader & Fragment Shader</h1>
      <div class="content">
        <div class="subtitle">
          Exemplu de declarare a shader-ilor
        </div>
        <img src="images/shaders.png" alt="">

        <a href="#page-14"><div class="arrow arrow-left"></div></a>
        <a href="#page-16"><div class="arrow arrow-right"></div></a>
      </div>
    </div>

    <div class="container" id="page-16">
      <h1 class="title">Shader program</h1>
      <div class="content">
        <div class="subtitle">Compilarea shaderilor si crearea programului
        de shader:</div>
        <img src="images/program.png" alt="">
      </div>
      <a href="#page-15"><div class="arrow arrow-left"></div></a>
      <a href="#page-17"><div class="arrow arrow-right"></div></a>
    </div>

    <div class="container" id="page-17">
      <h1 class="title">Textura</h1>
      <div class="content">
        <div class="subtitle"></div>
        <img src="images/texture.png" alt="">
      </div>
      <a href="#page-16"><div class="arrow arrow-left"></div></a>
      <a href="#page-18"><div class="arrow arrow-right"></div></a>
    </div>

    <div class="container" id="page-18">
      <h1 class="title">Iluminarea</h1>
      <div class="content">

        WebGL nu știe nimic despre iluminare. Datele
        despre fiecare vertex se stochează în variabile JavaScript de tip array.
        Acesta oferă, de asemenea, funcțiile pentru a face calculele necesare
        pentru a afla - în funcție de modelul de iluminare,
        care ar trebui să fie culoarea unui anumit pixel.
      </div>
      <a href="#page-17"><div class="arrow arrow-left"></div></a>
      <a href="#page-19"><div class="arrow arrow-right"></div></a>
    </div>

    <div class="container" id="page-19">
      <h1 class="title">Cub 3D</h1>
      <div class="content">
        <div>
          Tastați butonul de mai jos pentru randarea cuburilor 3D
        </div>
        <button class="btn" id="cubeBtn">Vizualizare cuburi</button>
        <!-- The Modal -->
        <div class="modal" id="cubeModal">
          <!-- Modal content -->
          <div class="modal-content">
            <p>Cub 3D</p>
            <span class="close">&times;</span>
            <canvas id="cube"></canvas>
            <canvas id="cubeTexture"></canvas>
            <canvas id="cubeLighting"></canvas>
          </div>
        </div>
      </div>
      <a href="#page-18"><div class="arrow arrow-left"></div></a>
      <a href="#page-20"><div class="arrow arrow-right"></div></a>
    </div>

    <div class="container" id="page-20">
      <h1 class="title">Randarea obiectelor</h1>
      <div class="content">
        <ul>
          <li>Generarea a N poziții aleatorii</li>
          <li>Crearea și inițializarea bufferilor</li>
          <li>Ciclu
            <ul>
              <li>N iterații
                <ul>
                  <li>setarea bufferilor</li>
                  <li>setarea attributelor</li>
                  <li>setarea uniformelor</li>
                  <li>desenare elemente</li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </div>
      <div class="footer">
        <a href="13 (100 objects)/index.html" target="_blank">Randare pagina noua</a>
      </div>
      <a href="#page-19"><div class="arrow arrow-left"></div></a>
      <a href="#page-21"><div class="arrow arrow-right"></div></a>
    </div>

    <div class="container" id="page-21">
      <h1 class="title">Optimizarea de randare a obiectelor</h1>
      <div class="content">
        <ul>
          <li>Generarea a N poziții aleatorii</li>
          <li>Crearea și inițializarea bufferilor</li>
          <li>setarea bufferilor</li>
          <li>setarea attributelor</li>
          <li>setarea uniformelor distribuite</li>
          <li>Ciclu
            <ul>
              <li>N iterații
                <ul>
                  <li>setarea uniformelor unice</li>
                  <li>desenare elemente</li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </div>
      <div class="footer">
        <a href="14 (optimize 1000)/index.html" target="_blank">Randare pagina noua</a>
      </div>
      <a href="#page-20"><div class="arrow arrow-left"></div></a>
      <a href="#page-22"><div class="arrow arrow-right"></div></a>
    </div>

    <div class="container" id="page-22">
      <h1 class="title">Randare obiecte diferite</h1>
      <div class="content">
        <ul>
          <li>Generarea a N poziții aleatorii</li>
          <li>Ciclu
            <ul>
              <li>N iterații
                <ul>
                  <li>Crearea și inițializarea buffer obiect 1</li>
                  <li>setarea bufferilor</li>
                  <li>setarea attributelor</li>
                  <li>setarea uniformelor</li>
                  <li>desenare elemente</li>
                  <br>
                  <li>Crearea și inițializarea buffer obiect 2</li>
                  <li>setarea bufferilor</li>
                  <li>setarea attributelor</li>
                  <li>setarea uniformelor</li>
                  <li>desenare elemente</li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </div>
      <div class="footer">
        <a href="15.0/index.html" target="_blank">Randare obiecte diferite</a>
      </div>
      <a href="#page-21"><div class="arrow arrow-left"></div></a>
      <a href="#page-23"><div class="arrow arrow-right"></div></a>
    </div>

    <div class="container" id="page-23">
      <h1 class="title">Optimizare randare obiecte diferite</h1>
      <div class="content">
        <ul>
          <li>Generarea a N poziții aleatorii</li>
          <li>setarea uniformelor distribuite</li>
          <li>Ciclu
            <ul>
              <li>N iterații
                <ul>
                  <li>Crearea și inițializarea buffer obiect 1</li>
                  <li>setarea bufferilor</li>
                  <li>setarea attributelor</li>
                  <li>setarea uniformelor unice</li>
                  <li>desenare elemente</li>
                </ul>
              </li>
              <li>N iterații
                <ul>
                  <li>Crearea și inițializarea buffer obiect 2</li>
                  <li>setarea bufferilor</li>
                  <li>setarea attributelor</li>
                  <li>setarea uniformelor unice</li>
                  <li>desenare elemente</li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </div>
      <div class="footer">
        <a href="15.1/index.html" target="_blank">Randare obiecte diferite</a>
      </div>
      <a href="#page-22"><div class="arrow arrow-left"></div></a>
      <a href="#page-24"><div class="arrow arrow-right"></div></a>
    </div>

    <div class="container" id="page-24">
      <h1 class="title">Perlin noise</h1>
      <div class="content">

      </div>
      <div class="footer">
        <a href="16 perlin/index.html" target="_blank">Link</a>
      </div>
      <a href="#page-23"><div class="arrow arrow-left"></div></a>
      <a href="#page-25"><div class="arrow arrow-right"></div></a>
    </div>
    <div class="container" id="page-25">
      <h1 class="title">Generare teren infinit</h1>
      <div class="content">

      </div>
      <div class="footer">
        <a href="16 perlin/index.html" target="_blank">Link</a>
      </div>
      <a href="#page-24"><div class="arrow arrow-left"></div></a>
      <a href="#page-26"><div class="arrow arrow-right"></div></a>
    </div>
    <div class="container" id="page-26">
      <h1 class="title"></h1>
      <div class="content">
        Vă mulțumesc pentru atenție
      </div>
      <div class="footer">
        <a href="16 perlin/index.html" target="_blank">Link</a>
      </div>
      <a href="#page-25"><div class="arrow arrow-left"></div></a>
      <!-- <a href="#page-27"><div class="arrow arrow-right"></div></a> -->
    </div>

  </section>

<script>

  document.querySelector(".arrow").addEventListener("click", function() {
    document.querySelector("#main-page").style.display = "none";
  });

  document.querySelector("#to-main-page").addEventListener("click", function() {
    document.querySelector("#main-page").style.display = "flex";
  });

  var canvas = document.querySelector("#myCanvas");
  var context = canvas.getContext("2d");
  var size = 50;
  context.fillStyle = 'rgb(0, 255, 255)';
  context.fillRect(0, 0, canvas.width, canvas.height);

  context.fillStyle = 'rgb(0,0,255)';
  context.fillRect(canvas.width / 2 - size , canvas.height / 2 - size,
  size * 2 , size * 2 );

  window.onload = function() {
    var url = window.location.href + '';
    document.querySelector("#main-page").style.display = "none";
    if(url.substr(-4) == 'html') {
      document.querySelector("#main-page").style.display = "flex";
    }
  }
</script>
<script>
  var canvas = document.querySelector('#glCanvas');
  var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
  const vertexSource = `
    attribute vec3 a_Position;

    void main() {
        gl_Position = vec4(a_Position, 1.0);
    }
  `;
  const fragmentSource = `
    void main() {
        gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0); //coloarea alba
    }
  `;
  const vertexShader = gl.createShader(gl.VERTEX_SHADER);
  const fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);

  gl.shaderSource(vertexShader, vertexSource);
  gl.shaderSource(fragmentShader, fragmentSource);
  gl.compileShader(vertexShader);
  gl.compileShader(fragmentShader);
  const program = gl.createProgram();

  gl.attachShader(program, vertexShader);
  gl.attachShader(program, fragmentShader);
  gl.linkProgram(program);

  const positionBuffer = gl.createBuffer();
  gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
  const vertices = [
    -0.5, -0.5, 0.0, //vertex 1
    -0.5, 0.5, 0.0,  //vertex 2
    0.5, 0.5, 0.0,   //vertex 3
    0.5, -0.5, 0.0,  //vertex 4
  ];
  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);

  const indexBuffer = gl.createBuffer();
  gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);
  const indices = [
    0, 1, 2, //primul triunghi
    0, 2, 3, //al doilea triunghi
  ];
  gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.STATIC_DRAW);

  const a_Position = gl.getAttribLocation(program, 'a_Position');
  gl.vertexAttribPointer(a_Position, 3, gl.FLOAT, false, 0, 0);
  gl.enableVertexAttribArray(a_Position);
  gl.useProgram(program);

  gl.clearColor(0.0, 1.0, 1.0, 1);
  gl.clear(gl.COLOR_BUFFER_BIT);
  gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);

</script>
<script>
  // Get the modal
  var modal = document.getElementById('myModal');
  var btn = document.getElementById("contextBtn");
  var span = document.getElementsByClassName("close")[0];
  var span1 = document.getElementsByClassName("close")[1];

  // When the user clicks the button, open the modal
  btn.onclick = function() {
      modal.style.display = "block";
  }
  var cubeIsRendering = false;
  document.querySelector('#cubeBtn').onclick = function() {
    if(cubeIsRendering == false){
      drawCube();
      drawCubeTexture();
      drawCubeLighting();
      cubeIsRendering = true;
  }
    document.querySelector('#cubeModal').style.display = "block";
  }
  // When the user clicks on <span> (x), close the modal

  span.onclick = function() {
    modal.style.display = "none";
  }
  span1.onclick = function() {
   document.querySelector('#cubeModal').style.display = "none";
  }


  // When the user clicks anywhere outside of the modal, close it
  window.onclick = function(event) {
      if (event.target == modal) {
          modal.style.display = "none";
      }
  }


</script>
<script src="utils/glMatrix.js" charset="utf-8"></script>
<script src="utils/webgl-utils.js" charset="utf-8"></script>
<script src="utils/primitives.js" charset="utf-8"></script>
<script src="08 3dCube\cube.js" charset="utf-8"></script>
<script src="09 3dCube (texture)\cubeTexture.js" charset="utf-8"></script>
<script src="10 3dCube (lighting)\cubeLighting.js" charset="utf-8"></script>
</body>

</html>
